<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard | Jedidiah Construction</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="logo">
      <img src="{{ url_for('static', filename='images/nologo.png') }}" 
      alt="Company Logo" class="nologo-img">  
      <h2>Jedidiah Construction</h2>
    </div>
    <div class="toggle-sidebar">
      <i class="fas fa-chevron-left"></i>
    </div>
    <nav>
      <ul>
        <li><a href="{{ url_for('dashboard') }}" class="active"><i class="fas fa-home"></i><span>Dashboard</span></a></li>
        {% set role = (session.get('role', 'EMPLOYEE') | upper) %}
        {% if role in ['ADMIN', 'MANAGER', 'ASSISTANT MANAGER'] %}
        <li><a href="{{ url_for('employees') }}"><i class="fas fa-users"></i><span>Employees</span></a></li>
        <li><a href="{{ url_for('projects') }}"><i class="fas fa-layer-group"></i><span>Projects</span></a></li>
        <li><a href="{{ url_for('attendance') }}"><i class="fas fa-calendar-check"></i><span>Attendance</span></a></li>
        <li><a href="{{ url_for('payroll') }}"><i class="fas fa-wallet"></i><span>Payroll</span></a></li>
        <li><a href="{{ url_for('payroll_overview') }}"><i class="fas fa-chart-line"></i><span>Project Cost Tracking</span></a></li>
        <li><a href="{{ url_for('reports') }}"><i class="fas fa-chart-pie"></i><span>Reports</span></a></li>
        {% elif role == 'EMPLOYEE' %}
        <!-- Employee: limited navigation -->
        <li><a href="{{ url_for('employees') }}"><i class="fas fa-id-badge"></i><span>My Info</span></a></li>
        <li><a href="{{ url_for('projects') }}"><i class="fas fa-layer-group"></i><span>Projects Assigned</span></a></li>
        <li><a href="{{ url_for('payroll') }}"><i class="fas fa-wallet"></i><span>Payroll Status</span></a></li>
        <li><a href="{{ url_for('attendance') }}"><i class="fas fa-calendar-check"></i><span>My Attendance</span></a></li>
        {% endif %}
        {% if role == 'ADMIN' %}
        <li><a href="{{ url_for('admin_settings') }}"><i class="fas fa-user-shield"></i><span>Admin Settings</span></a></li>
        {% endif %}
      </ul>
    </nav>
  </aside>

  <!-- Main Content -->
  <div class="main">
    <!-- Header -->
    <header class="topbar">
      <div class="search">
        <i class="fas fa-search"></i>
        <input type="text" placeholder="Search employees...">
      </div>
      <div class="top-actions">
        <div class="notification">
          <i class="fas fa-bell"></i>
        </div>
        <div class="user">
          <img src="https://ui-avatars.com/api/?name={{ username if username else 'Manager' }}&background=008080&color=fff" alt="User">
          <span>{{ username if username else "Manager" }}</span>
          <i class="fas fa-chevron-down"></i>
  
          <!-- Dropdown Menu -->
          <div class="user-dropdown">
            <a href="{{ url_for('logout') }}">
              <i class="fas fa-sign-out-alt"></i> Logout
            </a>
          </div>
        </div>
      </div>
    </header>
  

    <main>
      <div class="page-title">
        <h1>Dashboard Overview</h1>
      </div>

      <!--
      <div class="cards">
        <div class="card">
          <i class="fas fa-users card-icon"></i>
          <h3>{{ total_employees }}</h3>
          <p>Total Employees</p>
        </div>
      
        <div class="card">
          <i class="fas fa-layer-group card-icon"></i>
          <h3>{{ active_projects }}</h3>
          <p>Active Projects</p>
        </div>
      
        <div class="card">
          <i class="fas fa-calendar-check card-icon"></i>
          <h3>{{ attendance_rate }}%</h3>
          <p>Attendance Rate Today</p>
        </div>
      
        <div class="card">
          <i class="fas fa-wallet card-icon"></i>
          <h3>â‚±{{ "{:,.2f}".format(payroll_month) }}</h3>
          <p>Payroll This Month</p>
        </div>
      </div>
    -->

      <!-- Quick Links -->
      <div class="table-container">
        <div class="table-header">
          <h2>Quick Access</h2>
        </div>
        <table>
          <thead>
            <tr>
              <th>Section</th>
              <th>Description</th>
              <th>Go To</th>
            </tr>
          </thead>
          <tbody>
            <td>Employees</td>
            <td>Manage Employess details</td>
            <td><a class="btn btn-primary" href="{{ url_for('employees') }}">Open</a></td>
          </tr>
            <tr>
              <td>Projects</td>
              <td>Manage project details and Department assigned</td>
              <td><a class="btn btn-primary" href="{{ url_for('projects') }}">Open</a></td>
            </tr>
            <tr>
              <td>Attendance</td>
              <td>Track attendance per project and by calendar</td>
              <td><a class="btn btn-primary" href="{{ url_for('attendance') }}">Open</a></td>
            </tr>
            <tr>
              <td>Payroll</td>
              <td>Generate payroll and manage salary rates</td>
              <td><a class="btn btn-primary" href="{{ url_for('payroll') }}">Open</a></td>
            </tr>
            <tr>
              <td>Reports</td>
              <td>Create and export company reports</td>
              <td><a class="btn btn-primary" href="{{ url_for('reports') }}">Open</a></td>
            </tr>
          </tbody>
        </table>
      </div>
    </main>
  </div>

  <script>
    // Sidebar toggle
    const toggleSidebar = document.querySelector('.toggle-sidebar');
    const sidebar = document.querySelector('.sidebar');
    
    toggleSidebar.addEventListener('click', () => {
      sidebar.classList.toggle('collapsed');
      const icon = toggleSidebar.querySelector('i');
      if (sidebar.classList.contains('collapsed')) {
        icon.classList.remove('fa-chevron-left');
        icon.classList.add('fa-chevron-right');
      } else {
        icon.classList.remove('fa-chevron-right');
        icon.classList.add('fa-chevron-left');
      }
    });
    const userMenu = document.querySelector('.user');
  const dropdown = document.querySelector('.user-dropdown');

  userMenu.addEventListener('click', () => {
    dropdown.style.display = dropdown.style.display === 'flex' ? 'none' : 'flex';
  });

  // Close dropdown when clicking outside
  window.addEventListener('click', (e) => {
    if (!userMenu.contains(e.target)) {
      dropdown.style.display = 'none';
    }
  });
  </script>
</body>
</html>
